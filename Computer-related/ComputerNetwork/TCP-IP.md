##物理层/数据链路层/网络层/运输层
为了实现跨越互联网的，主机 A 的进程 P1，和主机 B 的进程 P2 之间的通信，我们逐层把这个任务交给 TCP/IP 协议栈。
运输层：“如果有人能帮我把数据从某个网络中的机器 A 搬到另一个网络中的机器 B，我就可以搞定这个任务，因为我**知道不同的数据应该交给机器上的哪个进程。**”

网络层：“如果有人能帮我把数据从局域网中直接相连的一台机器搬到另一台机器，我就可以把数据从一个网络搬到另一个网络，因为我**知道路线怎么走，要经过哪些节点**。”（网络层管跨区域交通，区域间的交通需要有链路层和物理层）

链路层：“我**知道怎样在局域网中搬数据**，还能用 CSMA/CD 协议协调工作，还能用 CRC32 校验发送的数据和接收的数据是一致的，blabla...  But，我只是说说，我不干苦力活。”（链路层只管局域网中的交通）

物理层：“楼上的大爷们发话了，兄弟们上。”（将数据转化为物理信号的层）





##常见通信协议
HTTP、FTP、DHCP、DNS、ARP等

###TCP/IP
发送一条消息需要三个过程：
建立连接、发送数据、释放连接
通过TCP协议在两台电脑建立网络连接之前要先发数据包进行沟通，沟通后再建立连接，然后才是信息的传输。（对比UDP协议，类似于我们的校园广播，广播内容已经通过广播站播放出去了，你能不能听到，那就与广播站无关了）


![数据包的结构][数据包的结构]
[数据包的结构]: https://pic4.zhimg.com/80/v2-b336a50e1d671a5ef82f532c492474fe_hd.jpg
####数据包结构与邮寄信息：
邮件信件需要填写“收件人姓名”、“收件人地址”和“寄件人姓名”、“寄件人地址”的组合，这样才能保证信件能准确投递到具体的收件人手中。
寄件人地址==源ip地址
寄件人姓名==源端口号
收件人地址==目的ip地址
收件人姓名==目的端口号

####传递数据包与发QQ消息
我给岁岁通过QQ发送了一条消息，我的电脑将此消息打包成TCP数据包发送到计算机网络中，计算机网络通过数据包中的目的IP地址把该数据包准确传递到岁岁的电脑。
岁岁的电脑收到了我的电脑发送过来的数据包，但是岁岁的电脑上同时运行有多个程序（例如QQ和MSN），虽然岁岁的电脑知道这个数据包是传输给它的，但是它不知道该把这个数据包中的数据交给那个程序。
如果我们使用数据包结构中的源端口号和目的端口号，根据**不同的程序使用不同的端口号来发送和接受数据**，这样数据包就能像邮寄信件一样准确投递到具体的电脑上指定的程序了。例如我们指定QQ和MSN使用的端口号分别是8000和8080，那么只要你的电脑接收的数据包里目的端口号是8000，那这个数据包就是传输给QQ的。

####TCP校验
例如我们收到信后可以简单地通过信封是否完整来检查该信件是否被别人在传输途中拆开并篡改过信件内容，那么我们怎么保证我们收到的数据包里的数据有没有在中途被别人拆开修改过呢？

####传递信息也需要额外的花销
寄信时，没有信封、邮票和信纸这些花销，你的信息就无法通过邮局传递。通过计算机网络传递信息也需要额外的花销，这些花销体现在计算机网络里就是TCP/IP的各种协议数据包的头部（除去应用层数据之外的其他信息）


####ip地址
IP地址是一种逻辑地地址，用来标识网络中一个个主机，IP有唯一性，即每台机器的IP在全世界是唯一的

####DNS
我们的电脑在生成数据包时是怎么知道对方电脑的ip地址的?
DNS服务器用来将域名转换成 IP 地址。只有浏览网页(需输入网址时)才用到DNS。 

####子网掩码
子网掩码是用来**判断任意两台计算机的ip地址是否属于同一子网络**的根据。最为简单的理解就是两台计算机各自的ip地址与子网掩码进行and运算后，得出的结果是相同的，则说明这两台计算机是处于同一个子网络上的，可以进行直接的通讯。



####网关
我们的信件是最开始是通过邮局帮我们邮寄的，那么我们的电脑的数据包应该由谁来帮我们传输呢？
网关是不同网络之间相互通信的桥梁。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机。比如：院子A的小明想跟院子B的小白说话，则小明需要先跟院子A的看门大爷说一声，让看门大爷跟院子B的看门大爷联系上，让院子B的看门大爷去把小白叫来接电话。这个例子中，想要说的话就是数据包，两个看门大爷分别是两个院子的网关，小明是源ip地址，小白是目的ip。

> 相关链接：如何形象生动的解释ip地址、子网掩码、网关等概念？ - 顾斯比的回答 - 知乎
https://www.zhihu.com/question/20717354/answer/15968282

#####默认网关
一台主机如果找不到可用的网关，就把数据包发给默认指定的网关，由这个网关来处理数据包。

####路由
网关又是如何帮我们把数据包传输到目的地的？
路由指出了**从源ip地址到目的ip地址之间需要经过的节点**。
5.x-(5.1@1.1)——……——(1.2@8.1)-8.x
　　　　　　　　　|
　　　　　　　　　(1.3@10.1)-10.x
假设地址为5.3的小明想找地址为10.7的小红聊天，则：
电脑一看10.7，不是一个网的，然后就去查路由表，也没有，就扔给了默认网关5.1，5.1是一号路由器，它左边地址是5.1，右边地址是1.1。一号路由器一检查路由表，发现有一条记录着通往10.x网络的网关地址是1.3，于是从1.1发给1.3，1.3的三号路由器转过头来交给10.1（默认网关），然后10.1传给10.7。



###TCP/IP协议的学习
利用模拟器（cisco packet tracer）可以像看动画一样看到网络数据包是如何在网络拓扑结构中传输和交互。

###分布式共享内存(Distributed Shared Memory)-DSM
共享内存的计算模型最终目的是让用户可以像写单机多线程程序那样写分布式程序，大家可以直接像使用单机内存那样使用远端的内存，然后**多机的多进程来共同访问同一段内存**（相当于单机程序中的多线程访问同一块内存），然后利用一些分布式锁服务来保证同步之类的，进而实现分布式化。
按照**函数式编程**的思想写出来的程序对状态依赖较少，容易分布式化，如mapreduce就是借鉴了函数式编程中很常见的map和reduce函数。

###一致性
并行处理的结果，等价于一个单核单内存执行相同指令的结果。

####为什么需要关心一致性？
因为现在的CPU和编译器会对代码做各种各样的优化，有时候它们可能会为了优化性能而把写程序时规定的代码执行顺序(program order)打乱，导致程序执行结果是错误的。

####顺序一致性
![顺序一致性][顺序一致性]
[顺序一致性]: http://wiki.jikexueyuan.com/project/java-memory-model/images/10.png
-  概念上，顺序一致性模型有一个单一的全局内存，在**任意时间点最多只能有一个线程可以连接到内存**。
-  顺序一致性内存模型中的**每个操作必须对任意线程可见**。


##大数据分析都在干啥？
大数据分析，1）写mapreduce代码，这种方式写的代码量多，不易维护不便共享思路，还容易出错，13年时我所在的一个策略组就这么玩的。2）hiveql（百度版本是queryengine），一个sql搞定轻松搞定join、groupby这种写mapreduce会吐血的分析。3）sparksql（还是sql但飞快，百度版本是pingo），调研迭代起来大大提升效率。大数据挖掘呢，特征数据整理好后选算法，1）单机的sklearn、r、libsvm，2）单机搞不定的有集群平台，都是调参即可。所以，基本不写代码。要写，那就是sql（数据分析和数据提取）+shell&awk（随手写简单处理数据）+python（sql搞不定的session分析，分析上下文有顺序，调用sklearn或算法平台）

